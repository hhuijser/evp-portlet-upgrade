YUI.add("aui-scheduler-view-agenda",function(e,t){var n=e.Lang,r=n.isFunction,i=n.isNumber,s=e.Array,o=e.DataType.DateMath,u="%H:%M",a="%l:%M",f=".",l="",c="&mdash;",h=" ",p="activeView",d="agenda",v="biggie",m="bodyContent",g="boundingBox",y="clearfix",b="click",w="clientId",E="color",S="container",x="content",T="date",N="dates",C="day",k="disabled",L="endDate",A="event",O="eventRecorder",M="events",_="eventsDateFormatter",D="extra",P="first",H="header",B="headerContent",j="headerDayDateFormatter",F="headerExtraDateFormatter",I="info",q="infoDayDateFormatter",R="infoLabelBigDateFormatter",U="infoLabelSmallDateFormatter",z="isoTime",W="label",X="last",V="locale",$="no",J="noEvents",K="past",Q="pm",G="scheduler",Y="schedulerEvent",Z="small",et="startDate",tt="strings",nt="timestamp",rt="today",it="todayDate",st="viewDate",ot="visible",ut="scheduler-view-agenda",at=function(t){return function(n){var r=this,i=r.get(G);return e.DataType.Date.format(n,{format:t,locale:i.get(V)})}},ft=function(e){return s.map(e,function(e){return+e}).sort(s.numericSort)},lt=e.getClassName,ct=lt(ut,S),ht=lt(ut,A),pt=lt(ut,A,E),dt=lt(ut,A,x),vt=lt(ut,A,N),mt=lt(ut,A,P),gt=lt(ut,I),yt=lt(ut,I,v),bt=lt(ut,I,S),wt=lt(ut,I,W),Et=lt(ut,I,W,v),St=lt(ut,I,W,Z),xt=lt(ut,A,X),Tt=lt(ut,$,M),Nt=lt(ut,A,K),Ct=lt(ut,M),kt=lt(ut,H),Lt=lt(ut,H,C),At=lt(ut,H,D),Ot=lt(ut,H,P),Mt=lt(ut,H,X),_t=lt(y),Dt='<div class="'+ct+'">{content}</div>',Pt='<div class="'+[kt,_t].join(h)+' {firstClassName} {lastClassName}">'+'<div class="'+Lt+'">{day}</div>'+'<a href="javascript:;" class="'+At+'" data-timestamp="{timestamp}">{extra}</a>'+"</div>",Ht='<div class="'+Ct+'">{content}</div>',Bt='<div class="'+[ht,_t].join(h)+' {firstClassName} {lastClassName} {eventClassName}" data-clientId="{clientId}">'+'<div class="'+pt+'" style="background-color: {color};"></div>'+'<div class="'+dt+'">{content}</div>'+'<div class="'+vt+'">{dates}</div>'+"</div>",jt='<div class="'+Tt+'">{content}</div>',Ft='<div class="'+bt+'">'+'<div class="'+[gt,_t].join(h)+'">'+'<div class="'+yt+'">{day}</div>'+'<div class="'+wt+'">'+'<div class="'+Et+'">{labelBig}</div>'+'<div class="'+St+'">{labelSmall}</div>'+"</div>"+"</div>"+"</div>",It=e.Component.create({NAME:ut,ATTRS:{bodyContent:{value:l},daysCount:{value:30,validator:i},eventsDateFormatter:{value:function(e,t){var n=this,r=n.get(G),i=r.get(p).get(z),s=u,f=u,l,d;return i||(s=a,f=a,e.getHours()>=12&&(s+=Q),t.getHours()>=12&&(f+=Q)),o.isDayOverlap(e,t)&&(s+=", %b %e",f+=", %b %e"),l=at.call(n,s),d=at.call(n,f),[l.call(n,e),c,d.call(n,t)].join(h)},validator:r},headerDayDateFormatter:{value:function(e){var t=this,n=t.get(G).get(it),r,i;return o.isDayOverlap(e,n)?r="%A":r=rt,i=at.call(t,r),i.call(t,e)},validator:r},headerExtraDateFormatter:{validator:r,value:at("%B %e")},infoDayDateFormatter:{validator:r,value:at("%e")},infoLabelBigDateFormatter:{validator:r,value:at("%A")},infoLabelSmallDateFormatter:{validator:r,value:at("%B %d, %Y")},name:{value:d},strings:{value:{noEvents:"No future events."}}},EXTENDS:e.SchedulerView,UI_ATTRS:["daysCount"],prototype:{bindUI:function(){var e=this,t=e.get(g);t.delegate(b,e._onSchedulerEventClick,f+ht,e),t.delegate(b,e._onEventsHeaderClick,f+At,e)},getDateInterval:function(){var e=It.superclass.getDateInterval.apply(this);return delete e.endDate,e},getNextDate:function(){var e=this,t=e.get(G).get(st);return o.toMidnight(o.add(t,o.DAY,1))},getPrevDate:function(){var e=this,t=e.get(G).get(st);return o.toLastHour(o.subtract(t,o.DAY,1))},plotEvents:function(){var t=this,n=t.get(tt),r=t.get(G),i=r.get(st),u=t.get(_),a=t.get(j),f=t.get(F),c=t.get(q),h=t.get(R),p=t.get(U),d=[],v=t._getDayEventsMap(),g=e.Object.keys(v),y=g.length;t.set(B,e.Lang.sub(Ft,{day:c.call(t,i),labelBig:h.call(t,i),labelSmall:p.call(t,i)})),e.Object.isEmpty(v)?d.push(e.Lang.sub(jt,{content:n[J]})):s.each(ft(g),function(n,r){var i=new Date(e.Lang.toInt(n)),c=v[n],h=c.length;d.push(e.Lang.sub(Pt,{day:a.call(t,i),extra:f.call(t,i),firstClassName:r===0?Ot:l,lastClassName:r===y-1?Mt:l,timestamp:n})),s.each(c,function(n,r){var s=o.toMidnight(new Date),a=n.get(L),f=n.get(et);d.push(e.Lang.sub(Bt,{clientId:n.get(w),color:n.get(E),content:n.get(x),dates:u.call(t,f,a),eventClassName:i.getTime()<s.getTime()||a.getTime()<s.getTime()?Nt:l,firstClassName:r===0?mt:l,lastClassName:r===h-1?xt:l}))})});var b=e.Lang.sub(Dt,{content:e.Lang.sub(Ht,{content:d.join(l)})});t.set(m,b)},_getDayEventsMap:function(){var e=this,t=e.get("daysCount"),n=e.get(G),r=o.toMidnight(n.get(st)),i=o.add(r,o.DAY,t-1),s={};return n.eachEvent(function(e){var t=e.get(L),n=e.get(et),u=e.get(ot),a;if(!u)return;var f=n;o.before(i,t)&&(t=i);while(f.getTime()<=t.getTime())f.getTime()>=r.getTime()&&(a=o.safeClearTime(f).getTime(),s[a]||(s[a]=[]),s[a].push(e)),f=o.add(f,o.DAY,1)}),s},_onEventsHeaderClick:function(t){var n=this,r=n.get(G),i=t.currentTarget,s=e.Lang.toInt(i.getData(nt))||Date.now(),o=new Date(s),u=r.getViewByName(C);u&&(r.set(T,o),r.set(p,u))},_onSchedulerEventClick:function(e){var t=this,n=e.currentTarget,r=t.get(G),i=r.get(O),s=n.getData(Y);s||(s=r.getEventByClientId(n.getData(w)),n.setData(Y,s)),s&&i&&(i.set(A,s,{silent:!0}),i.showPopover(n))},_uiSetDaysCount:function(){var e=this;e.plotEvents()}}});e.SchedulerAgendaView=It},"2.0.0",{requires:["aui-scheduler-base"],skinnable:!0});
