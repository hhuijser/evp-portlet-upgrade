YUI.add("aui-form-validator",function(e,t){var n=e.Lang,r=e.Object,i=n.isBoolean,s=n.isDate,o=r.isEmpty,u=n.isFunction,a=n.isObject,f=n.isString,l=n.trim,c=function(t){return t instanceof e.Node},h=e.namespace("config.FormValidator"),p=e.DOM._getRegExp,d="form-validator",v=".",m="",g='input:not([type="file"]),select,textarea,button',y='input[type="file"]',b="input,select,textarea,button",w="Invalid Date",E="|",S=" ",x="blur",T="change",N="errorField",C="input",k="submitError",L="validateField",A="validField",O="aria-required",M="boundingBox",_="checkbox",D="containerErrorClass",P="containerValidClass",H="control",B="error",j="errorClass",F="field",I="fieldContainer",q="fieldStrings",R="focus",U="group",z="help",W="inline",X="labelCssClass",V="messageContainer",t="name",$="radio",J="rules",K="selectText",Q="showAllMessages",G="showMessages",Y="stack",Z="stackErrorContainer",et="strings",tt="submit",nt="success",rt="type",it="validClass",st="validateOnBlur",ot="validateOnInput",ut=e.getClassName,at=ut(H,U),ft=ut(B),lt=ut(B,F),ct=ut(nt),ht=ut(nt,F),pt=ut(z,W),dt=ut(d,Y),vt='<div role="alert"></div>',mt='<div class="'+[dt,pt].join(S)+'"></div>';e.mix(h,{STRINGS:{DEFAULT:"Please fix this field.",acceptFiles:"Please enter a value with a valid extension ({0}).",alpha:"Please enter only alpha characters.",alphanum:"Please enter only alphanumeric characters.",date:"Please enter a valid date.",digits:"Please enter only digits.",email:"Please enter a valid email address.",equalTo:"Please enter the same value again.",iri:"Please enter a valid IRI.",max:"Please enter a value less than or equal to {0}.",maxLength:"Please enter no more than {0} characters.",min:"Please enter a value greater than or equal to {0}.",minLength:"Please enter at least {0} characters.",number:"Please enter a valid number.",range:"Please enter a value between {0} and {1}.",rangeLength:"Please enter a value between {0} and {1} characters long.",required:"This field is required.",url:"Please enter a valid URL."},REGEX:{alpha:/^[a-z_]+$/i,alphanum:/^\w+$/,digits:/^\d+$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,iri:/^([a-z]([a-z]|\d|\+|-|\.)*):(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!\$&'\(\)\*\+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,number:/^[+\-]?(\d+([.,]\d+)?)+([eE][+-]?\d+)?$/,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},RULES:{acceptFiles:function(t,n,r){var i=null;if(f(r)){var s=r.replace(/\./g,"").split(/,\s*|\b\s*/);s=e.Array.map(s,e.Escape.regex),i=p("[.]("+s.join(E)+")$","i")}return i&&i.test(t)},date:function(e,t,n){var r=new Date(e);return s(r)&&r!==w&&!isNaN(r)},equalTo:function(t,n,r){var i=e.one(r);return i&&l(i.val())===t},hasValue:function(n,r){var i=this;if(e.FormValidator.isCheckable(r)){var s=r.get(t),o=e.all(i.getFieldsByName
(s));return o.filter(":checked").size()>0}return!!n},max:function(e,t,r){return n.toFloat(e)<=r},maxLength:function(e,t,n){return e.length<=n},min:function(e,t,r){return n.toFloat(e)>=r},minLength:function(e,t,n){return e.length>=n},range:function(e,t,r){var i=n.toFloat(e);return i>=r[0]&&i<=r[1]},rangeLength:function(e,t,n){var r=e.length;return r>=n[0]&&r<=n[1]},required:function(e,t,n){var r=this;return n===!0?h.RULES.hasValue.apply(r,[e,t]):!0}}});var gt=e.Component.create({NAME:d,ATTRS:{boundingBox:{setter:e.one},containerErrorClass:{value:ft,validator:f},containerValidClass:{value:ct,validator:f},errorClass:{value:lt,validator:f},extractRules:{value:!0,validator:i},fieldContainer:{value:v+at},fieldStrings:{value:{},validator:a},labelCssClass:{validator:f,value:"control-label"},messageContainer:{getter:function(t){return e.Node.create(t).clone()},value:vt},strings:{valueFn:function(){return h.STRINGS}},rules:{getter:function(e){var t=this;return t._rulesAlreadyExtracted||t._extractRulesFromMarkup(e),e},validator:a,value:{}},selectText:{value:!0,validator:i},showMessages:{value:!0,validator:i},showAllMessages:{value:!1,validator:i},stackErrorContainer:{getter:function(t){return e.Node.create(t).clone()},value:mt},validateOnBlur:{value:!0,validator:i},validateOnInput:{value:!1,validator:i},validClass:{value:ht,validator:f}},_setCustomRules:function(t){var n=this;e.each(t,function(t,n){e.config.FormValidator.RULES[n]=t.condition,e.config.FormValidator.STRINGS[n]=t.errorMessage})},addCustomRules:function(e){var t=this;a(e)&&t._setCustomRules(e)},isCheckable:function(e){var t=e.get(rt).toLowerCase();return t===_||t===$},EXTENDS:e.Base,prototype:{initializer:function(){var e=this;e.errors={},e._blurHandlers=null,e._fileBlurHandlers=null,e._fileInputHandlers=null,e._inputHandlers=null,e._rulesAlreadyExtracted=!1,e._stackErrorContainers={},e.bindUI(),e._uiSetValidateOnBlur(e.get(st)),e._uiSetValidateOnInput(e.get(ot))},bindUI:function(){var t=this,n=t.get(M),r=n.delegate(R,function(e){t._setARIARoles(),r.detach()},b);t.publish({errorField:{defaultFn:t._defErrorFieldFn},validField:{defaultFn:t._defValidFieldFn},validateField:{defaultFn:t._defValidateFieldFn}}),n.on({reset:e.bind(t._onFormReset,t),submit:e.bind(t._onFormSubmit,t)}),t.after({extractRulesChange:t._afterExtractRulesChange,validateOnBlurChange:t._afterValidateOnBlurChange,validateOnInputChange:t._afterValidateOnInputChange})},addFieldError:function(e,n){var r=this,i=r.errors,s=e.get(t);i[s]||(i[s]=[]),i[s].push(n)},clearFieldError:function(e){var t=c(e)?e.get("name"):e;f(t)&&delete this.errors[t]},eachRule:function(t){var n=this;e.each(n.get(J),function(e,r){u(t)&&t.apply(n,[e,r])})},findFieldContainer:function(e){var t=this,n=t.get(I);if(n)return e.ancestor(n)},focusInvalidField:function(){var e=this,t=e.get(M),n=t.one(v+ft);n&&(e.get(K)&&n.selectText(),n.focus(),n.scrollIntoView())},getField:function(t){var n=this;return f(t)&&(t=n.getFieldsByName(t),t&&t.length&&!t.name&&(t=t[0])),e.one(t)},getFieldsByName:function(e){var t=this,n=t.get(M).getDOM();return n.elements[e]},getFieldError:function(e){var n=this;return n.errors[e.get(t)]},getFieldStackErrorContainer:function(e){var t=this,n=c(e)?e.get("name"):e,r=t._stackErrorContainers;return r[n]||(r[n]=t.get(Z)),r[n]},getFieldErrorMessage:function(r,i){var s=this,o=r.get(t),u=s.get(q)[o]||{},a=s.get(J)[o],f=s.get(et),l={};if(i in a){var c=e.Array(a[i]);e.each(c,function(e,t){l[t]=[e].join(m)})}var h=u[i]||f[i]||f.DEFAULT;return n.sub(h,l)},hasErrors:function(){var e=this;return!o(e.errors)},highlight:function(t,n){var r=this,i,s,o;t&&(i=r.findFieldContainer(t),s=t.get("name"),this.validatable(t)?(o=e.all(r.getFieldsByName(s)),o.each(function(e){r._highlightHelper(e,r.get(j),r.get(it),n)}),i&&r._highlightHelper(i,r.get(D),r.get(P),n)):t.val()||r.resetField(s))},normalizeRuleValue:function(e,t){var n=this;return u(e)?e.apply(n,[t]):e},unhighlight:function(e){var t=this;t.highlight(e,!0)},printStackError:function(t,n,r){var i=this;i.get(Q)||(e.Array.indexOf(r,"required")!==-1?r=["required"]:r=r.slice(0,1)),n.empty(),e.Array.each(r,function(e,r){var s=i.getFieldErrorMessage(t,e),o=i.get(V).addClass(e);n.append(o.html(s))})},resetAllFields:function(){var e=this;e.eachRule(function(t,n){e.resetField(n)})},resetField:function(t){var n=this,r,i,s;r=c(t)?t.get("name"):t,n.clearFieldError(r),s=n.getFieldStackErrorContainer(r),s.remove(),i=e.all(n.getFieldsByName(r)),i.each(function(e){n.resetFieldCss(e)})},resetFieldCss:function(t){var n=this,r=n.findFieldContainer(t),i=function(t,r){t&&e.each(r,function(e){t.removeClass(n.get(e))})};i(t,[it,j]),i(r,[P,D])},validatable:function(e){var n=this,r=!1,i=n.get(J)[e.get(t)];return i&&(r=i.custom||n.normalizeRuleValue(i.required)||h.RULES.hasValue.apply(n,[e.val(),e])),!!r},validate:function(){var e=this;e.eachRule(function(t,n){e.validateField(n)}),e.focusInvalidField()},validateField:function(e){var t=this,n,r;t.resetField(e),n=f(e)?t.getField(e):e,c(n)&&(r=t.validatable(n),r&&t.fire(L,{validator:{field:n}}))},_afterExtractRulesChange:function(e){var t=this;t._uiSetExtractRules(e.newVal)},_afterValidateOnBlurChange:function(e){var t=this;t._uiSetValidateOnBlur(e.newVal)},_afterValidateOnInputChange:function(e){var t=this;t._uiSetValidateOnInput(e.newVal)},_defErrorFieldFn:function(t){var n=this,r,i,s,o,u;i=n.get(X),u=t.validator,r=u.field,n.highlight(r),n.get(G)&&(o=r,s=n.getFieldStackErrorContainer(r),e.FormValidator.isCheckable(o)&&(o=r.ancestor("."+ft).get("lastChild")),o.placeAfter(s),n.printStackError(r,s,u.errors))},_defValidFieldFn:function(e){var t=this,n=e.validator.field;t.unhighlight(n)},_defValidateFieldFn:function(n){var r=this,i=n.validator.field,s=r.get(J)[i.get(t)];e.each(s,function(e,t){var n=h.RULES[t],s=l(i.val());e=r.normalizeRuleValue(e,i),u(n)&&!n.apply(r,[s,i,e])&&r.addFieldError(i,t)});var o=r.getFieldError(i);o?r.fire(N,{validator:{field:i,errors:o}}):r.fire(A,{validator:{field:i}})},_findFieldLabel:function(t){var n="."+
this.get("labelCssClass"),r=e.one("label[for="+t.get("id")+"]")||t.ancestor().previous(n)||t.ancestor("."+ft).one(n);if(r)return r.get("text")},_highlightHelper:function(e,t,n,r){r?e.removeClass(t).addClass(n):e.removeClass(n).addClass(t)},_extractRulesFromMarkup:function(e){var t=this,n=t.get(M).getDOM(),i=n.elements,s=r.keys(h.RULES),o=s.join("|"),u=p("field-("+o+")","g"),a,f,l=[],c=function(e,t){l.push(t)};for(a=0,f=i.length;a<f;a++){var d=i[a],v=d.name;d.className.replace(u,c);if(l.length){var m=e[v],g,y;m||(m={},e[v]=m);for(g=0,y=l.length;g<y;g++){var b=l[g];b in m||(m[b]=!0)}l.length=0}}t._rulesAlreadyExtracted=!0},_onFieldInput:function(e){var t=this;t.validateField(e.target)},_onFormSubmit:function(e){var t=this,n={validator:{formEvent:e}};t.validate(),t.hasErrors()?(n.validator.errors=t.errors,t.fire(k,n),e.halt()):t.fire(tt,n)},_onFormReset:function(e){var t=this;t.resetAllFields()},_setARIARoles:function(){var e=this;e.eachRule(function(t,n){var r=e.getField(n),i=e.normalizeRuleValue(t.required,r);i&&r&&!r.attr(O)&&r.attr(O,!0)})},_uiSetExtractRules:function(e){var t=this;e&&t._extractRulesFromMarkup(t.get(J))},_uiSetValidateOnInput:function(e){var t=this,n=t.get(M);e?(t._inputHandlers||(t._inputHandlers=n.delegate(C,t._onFieldInput,g,t)),t._fileInputHandlers||(t._fileInputHandlers=n.delegate(T,t._onFieldInput,y,t))):(t._inputHandlers&&t._inputHandlers.detach(),t._fileInputHandlers&&t._fileInputHandlers.detach())},_uiSetValidateOnBlur:function(e){var t=this,n=t.get(M);e?(t._blurHandlers||(t._blurHandlers=n.delegate(x,t._onFieldInput,g,t)),t._fileBlurHandlers||(t._fileBlurHandlers=n.delegate(T,t._onFieldInput,y,t))):(t._blurHandlers&&t._blurHandlers.detach(),t._fileBlurHandlers&&t._fileBlurHandlers.detach())}}});e.each(h.REGEX,function(e,t){h.RULES[t]=function(e,n,r){return h.REGEX[t].test(e)}}),e.FormValidator=gt},"2.0.0",{requires:["escape","selector-css3","node-event-delegate","aui-node","aui-component","aui-event-input"]});
